{"version":3,"file":"/js/game.js","mappings":"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","sources":["webpack://lucky-puffin/./resources/js/game.js"],"sourcesContent":["/**\n * Lucky Puffin — game.js (Laravel Mix / Webpack)\n *\n * THE FIX: app.js and game.js are separate Webpack bundles.\n * window.Echo is created in app.js but game.js may run before it finishes.\n *\n * Solution: wait for 'echo:ready' custom event dispatched by app.js,\n * with a 100ms polling fallback in case scripts load out of order.\n */\n\n// ── State ─────────────────────────────────────────────────────────────────────\nlet playerId        = null;\nlet playerBalance   = 0;\nlet playerName      = null;\n\nlet currentRound    = null;\nlet currentBets     = { player: 0, banker: 0, tie: 0, playerPair: 0, bankerPair: 0, randomPair: 0 };\nlet selectedChip    = 0;\nlet hasBetThisRound = false;\nlet dealingShown    = false;\n\n// Client-side countdown driven by round_ends_at (UTC ISO string from server).\n// Recalculates remaining each tick from the authoritative timestamp so it\n// stays accurate across tab-sleep, network jitter, etc.\n// When it hits 0 it calls fetchInitialState() to trigger server-side dealing.\nlet localCountdownTimer  = null;\nlet currentRoundEndsAt   = null;   // ISO string; null when round is not betting\n\nconst API_BASE = '/api/v1';\n\n// ── Entry point ───────────────────────────────────────────────────────────────\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    readPlayerData();\n\n    if (window.echoReady && window.Echo) {\n        // app.js already finished — boot immediately\n        boot();\n    } else {\n        // Wait for app.js to signal Echo is ready\n        document.addEventListener('echo:ready', boot, { once: true });\n\n        // Fallback polling: check every 100ms, give up after 5s\n        let attempts = 0;\n        const poll = setInterval(() => {\n            if (window.Echo) {\n                clearInterval(poll);\n                document.removeEventListener('echo:ready', boot);\n                boot();\n            } else if (++attempts > 50) {\n                clearInterval(poll);\n                console.error('[Game] Echo not available after 5s — check app.js loaded before game.js');\n                setTimerLabel('WebSocket error — please refresh');\n            }\n        }, 100);\n    }\n});\n\nfunction readPlayerData() {\n    const app = document.getElementById('game-app');\n    if (!app) return;\n    playerId      = parseInt(app.dataset.playerId)  || null;\n    playerName    = app.dataset.playerName           || 'Guest';\n    playerBalance = parseInt(app.dataset.balance)    || 0;\n    updateBalanceDisplay();\n}\n\nfunction boot() {\n    console.log('[Game] Echo ready — subscribing to channels');\n    subscribeToGameTable();\n    subscribeToPlayerChannel();\n    fetchInitialState();\n}\n\n// ── WebSocket: Public channel ─────────────────────────────────────────────────\n\nfunction subscribeToGameTable() {\n    window.Echo.channel('game-table')\n\n        .listen('.round.started', (data) => {\n            console.log('[WS] round.started', data);\n            const myId       = currentRound ? (currentRound.id || currentRound.round_id) : null;\n            const isNewRound = !currentRound || myId !== data.round_id;\n            currentRound     = data;\n            dealingShown     = false;\n\n            if (isNewRound) {\n                stopLocalCountdown();\n                clearBets();\n                // Do NOT call hideOverlays() here — card animation / result overlay\n                // manage their own lifecycle (showSharedCards timeout, showResult countdown).\n            }\n\n            if (data.status === 'betting' && data.round_ends_at) {\n                enableBetting();\n                startLocalCountdown(data.round_ends_at);\n            } else {\n                setTimerLabel('Waiting for first bet...');\n                enableBetting();\n            }\n        })\n\n        // .timer.tick removed — countdown is now driven entirely by round_ends_at timestamp.\n\n        .listen('.bet.placed', (data) => {\n            addActivityItem('\\uD83C\\uDFB2 ' + data.player_name + ' bet ' + data.total_bet + ' WPUFF');\n            setPlayerCount(data.active_players);\n        })\n\n        .listen('.cards.dealt', (data) => {\n            console.log('[WS] cards.dealt', data);\n            if (dealingShown) return;\n            dealingShown = true;\n            currentRound = Object.assign({}, currentRound, data);\n            disableBetting();\n            setTimerLabel('Dealing cards...');\n            showSharedCards(data);\n\n            if (!hasBetThisRound) {\n                const pLen   = (data.player_cards || data.playerCards || []).length;\n                const bLen   = (data.banker_cards || data.bankerCards || []).length;\n                const waitMs = (Math.max(pLen, bLen) * 1000) + 1500 + 2000;\n                setTimeout(hideOverlays, waitMs);\n            }\n        })\n\n        .listen('.round.finished', (data) => {\n            console.log('[WS] round.finished', data);\n            showNextRoundCountdown(data.next_round_in);\n        });\n}\n\n// ── WebSocket: Private player channel ────────────────────────────────────────\n\nfunction subscribeToPlayerChannel() {\n    if (!playerId) return;\n\n    window.Echo.private('player.' + playerId)\n        .listen('.round.result', (data) => {\n            console.log('[WS] round.result', data);\n            playerBalance = data.new_balance;\n            updateBalanceDisplay();\n\n            const pLen   = (currentRound && currentRound.player_cards) ? currentRound.player_cards.length : 3;\n            const bLen   = (currentRound && currentRound.banker_cards) ? currentRound.banker_cards.length : 3;\n            const animMs = (Math.max(pLen, bLen) * 1000) + 1500;\n            setTimeout(function () { showResult(data); }, animMs);\n        });\n}\n\n// ── REST: Initial page load ───────────────────────────────────────────────────\n\nasync function fetchInitialState() {\n    try {\n        const res   = await window.axios.get(API_BASE + '/game/state');\n        const data  = res.data;\n        const round = data.current_round;\n\n        // Sync authoritative server balance — fixes balance showing 1000 after refresh\n        if (data.player_balance !== null && data.player_balance !== undefined) {\n            playerBalance = data.player_balance;\n            updateBalanceDisplay();\n        }\n\n        if (round) {\n            // Guard: never regress to an older round.\n            // If a WS round.started already advanced currentRound to round N,\n            // ignore any fetchInitialState response that returns round N-1\n            // (can happen when the request was in-flight during a round transition).\n            const currentId = currentRound\n                ? (currentRound.id || currentRound.round_id || 0)\n                : 0;\n            const serverId = round.id || 0;\n\n            if (serverId >= currentId) {\n                currentRound = round;\n                dealingShown = false;\n\n                if (round.round_status === 'waiting') {\n                    setTimerLabel('Waiting for first bet...');\n                    enableBetting();\n                } else if (round.round_status === 'betting' && round.round_ends_at) {\n                    enableBetting();\n                    startLocalCountdown(round.round_ends_at);\n                } else if (round.round_status === 'dealing' && round.player_cards && round.player_cards.length) {\n                    dealingShown = true;\n                    disableBetting();\n                    showSharedCards({\n                        player_cards: round.player_cards,\n                        banker_cards: round.banker_cards,\n                        player_total: round.player_total,\n                        banker_total: round.banker_total,\n                    });\n                }\n            }\n        }\n\n        if (data.leaderboard)     renderLeaderboard(data.leaderboard, data.active_players || {});\n        if (data.recent_activity) renderActivityFeed(data.recent_activity);\n        setPlayerCount(Object.keys(data.active_players || {}).length);\n\n    } catch (err) {\n        console.error('[Init] Failed to load game state:', err);\n        setTimerLabel('Connection error — refresh to retry');\n    }\n}\n\n// ── Betting ───────────────────────────────────────────────────────────────────\n\nasync function handleBetClick(box) {\n    if (!currentRound) return showToast('Loading...');\n\n    const status = currentRound.round_status || currentRound.status;\n    if (status !== 'waiting' && status !== 'betting') {\n        return showToast('Wait for the next round!');\n    }\n    if (selectedChip === 0) return showToast('Select a chip first!');\n\n    const betType = box.dataset.betType;\n    if (betType === 'player' && currentBets.banker > 0) return showToast('Cannot bet Player and Banker!');\n    if (betType === 'banker' && currentBets.player > 0) return showToast('Cannot bet Player and Banker!');\n\n    const projected = Object.assign({}, currentBets, { [betType]: currentBets[betType] + selectedChip });\n    const newTotal  = Object.values(projected).reduce(function (s, v) { return s + v; }, 0);\n    if (newTotal > playerBalance) return showToast('Insufficient balance!');\n\n    // Was the round waiting before this click? Used below to start the countdown.\n    const wasWaiting = status === 'waiting';\n\n    // Optimistic update\n    currentBets[betType] += selectedChip;\n    playerBalance        -= selectedChip;\n    updateBetDisplay(betType);\n    updateBalanceDisplay();\n    hasBetThisRound = true;\n\n    try {\n        const res = await window.axios.post(API_BASE + '/game/bet', {\n            round_id: currentRound.id || currentRound.round_id,\n            bets:     currentBets,\n        });\n\n        // Sync to server-authoritative balance (prevents drift across multi-chip clicks)\n        if (res.data.balance !== undefined) {\n            playerBalance = res.data.balance;\n            updateBalanceDisplay();\n        }\n\n        // If this bet just started the betting phase, record the end timestamp.\n        // RoundStarted WS event fires at the same time (from startBetting()), but\n        // the HTTP response may arrive first — startLocalCountdown is idempotent.\n        if (wasWaiting && res.data.round_status === 'betting' && res.data.round_ends_at) {\n            currentRound.round_status  = 'betting';\n            currentRound.round_ends_at = res.data.round_ends_at;\n            startLocalCountdown(res.data.round_ends_at);\n        }\n\n        showToast('+' + selectedChip + ' on ' + betType.toUpperCase());\n    } catch (err) {\n        // Roll back optimistic update\n        currentBets[betType] -= selectedChip;\n        playerBalance        += selectedChip;\n        hasBetThisRound       = Object.values(currentBets).some(function (v) { return v > 0; });\n        updateBetDisplay(betType);\n        updateBalanceDisplay();\n        const msg = err.response && err.response.data && err.response.data.message\n            ? err.response.data.message\n            : 'Bet failed — try again';\n        showToast(msg);\n        console.error('[Bet]', err);\n        // Sync with server — currentRound may be stale (wrong round_id).\n        // This also triggers server-side dealing if the round_ends_at has passed.\n        fetchInitialState();\n    }\n}\n\nasync function clearAllBets() {\n    const status = (currentRound && (currentRound.round_status || currentRound.status));\n    if (status !== 'betting') return showToast('Cannot clear bets now!');\n\n    const total = Object.values(currentBets).reduce(function (s, v) { return s + v; }, 0);\n    if (total === 0) return;\n\n    try {\n        const res = await window.axios.post(API_BASE + '/game/clear', {\n            round_id: currentRound.id || currentRound.round_id,\n        });\n        playerBalance = res.data.balance;\n        clearBets();\n        updateBalanceDisplay();\n        showToast('Cleared! ' + total + ' WPUFF refunded');\n    } catch (err) {\n        showToast('Could not clear bets');\n    }\n}\n\n// ── Card animation ────────────────────────────────────────────────────────────\n\nfunction showSharedCards(data) {\n    const overlay = document.getElementById('card-dealing-overlay');\n    const pHand   = document.getElementById('player-hand');\n    const bHand   = document.getElementById('banker-hand');\n    if (!overlay || !pHand || !bHand) return;\n\n    overlay.classList.add('active');\n    pHand.innerHTML = '';\n    bHand.innerHTML = '';\n    var pScore = document.getElementById('player-total-score');\n    var bScore = document.getElementById('banker-total-score');\n    if (pScore) pScore.textContent = '?';\n    if (bScore) bScore.textContent = '?';\n\n    const DELAY  = 1000;\n    const pCards = data.player_cards || data.playerCards || [];\n    const bCards = data.banker_cards || data.bankerCards || [];\n\n    pCards.forEach(function (card, i) {\n        setTimeout(function () { appendCard(pHand, card); }, i * DELAY);\n    });\n    bCards.forEach(function (card, i) {\n        setTimeout(function () { appendCard(bHand, card); }, (i * DELAY) + 500);\n    });\n\n    const totalMs = Math.max(pCards.length, bCards.length) * DELAY + 800;\n    setTimeout(function () {\n        if (pScore) pScore.textContent = data.player_total != null ? data.player_total : (data.playerTotal || '?');\n        if (bScore) bScore.textContent = data.banker_total != null ? data.banker_total : (data.bankerTotal || '?');\n    }, totalMs);\n}\n\nfunction appendCard(container, card) {\n    const el       = document.createElement('div');\n    el.className   = 'card-placeholder';\n    el.textContent = card.display;\n    el.style.color = ['♥', '♦'].indexOf(card.suit) !== -1 ? '#dc3545' : '#212529';\n    container.appendChild(el);\n}\n\nfunction showResult(data) {\n    hideOverlays();\n\n    const resultEl  = document.getElementById('result-overlay');\n    const titleEl   = document.getElementById('result-title');\n    const detailsEl = document.getElementById('result-details');\n    if (!resultEl) return;\n\n    resultEl.classList.add('active');\n    if (titleEl)   titleEl.textContent = (data.result || '').replace(/_/g, ' ');\n\n    var profit = data.profit || 0;\n    if (detailsEl) {\n        detailsEl.textContent = profit > 0\n            ? 'You won +' + profit + ' WPUFF \\uD83C\\uDF89'\n            : profit < 0\n                ? 'You lost ' + Math.abs(profit) + ' WPUFF \\uD83D\\uDE22'\n                : 'Tie \\u2014 bet returned';\n    }\n\n    startCountdown('result-countdown', 5, function () {\n        resultEl.classList.remove('active');\n    });\n}\n\nfunction showNextRoundCountdown(seconds) {\n    var wrapper = document.getElementById('next-round-wrapper');\n    if (!wrapper) return;\n    wrapper.classList.remove('d-none');\n    startCountdown('next-round-seconds', seconds, function () {\n        wrapper.classList.add('d-none');\n    });\n}\n\nfunction hideOverlays() {\n    var d = document.getElementById('card-dealing-overlay');\n    var r = document.getElementById('result-overlay');\n    if (d) d.classList.remove('active');\n    if (r) r.classList.remove('active');\n}\n\n// ── UI helpers ────────────────────────────────────────────────────────────────\n\nfunction clearBets() {\n    Object.keys(currentBets).forEach(function (k) { currentBets[k] = 0; updateBetDisplay(k); });\n    document.querySelectorAll('.betting-box').forEach(function (b) { b.classList.remove('disabled'); });\n    hasBetThisRound = false;\n}\n\nfunction enableBetting()  {\n    document.querySelectorAll('.betting-box').forEach(function (b) { b.classList.remove('disabled'); });\n}\nfunction disableBetting() {\n    document.querySelectorAll('.betting-box').forEach(function (b) { b.classList.add('disabled'); });\n}\n\n// ── Local countdown ───────────────────────────────────────────────────────────\n// Driven by the authoritative round_ends_at UTC timestamp from the server.\n// Recalculates remaining time every 500ms so it stays accurate through\n// tab-sleep, clock drift, and network delays.\n//\n// When it hits 0 → calls fetchInitialState() which triggers the atomic\n// dealing transition on the server (no cron/queue needed).\n//\n// Idempotent: calling with the same roundEndsAt while already running is a no-op.\n\nfunction startLocalCountdown(roundEndsAt) {\n    if (!roundEndsAt) return;\n    // Don't restart if we're already counting down to the same end time.\n    if (roundEndsAt === currentRoundEndsAt && localCountdownTimer) return;\n\n    stopLocalCountdown();\n    currentRoundEndsAt = roundEndsAt;\n\n    var tick = function () {\n        var remaining = Math.round((new Date(currentRoundEndsAt) - Date.now()) / 1000);\n\n        if (remaining <= 0) {\n            localCountdownTimer = null;\n            setTimerLabel('Dealing cards...');\n            // Trigger server-side dealing — the first caller wins the atomic race.\n            fetchInitialState();\n            return;\n        }\n\n        updateTimerDisplay(remaining);\n        localCountdownTimer = setTimeout(tick, 500);\n    };\n\n    tick();\n}\n\nfunction stopLocalCountdown() {\n    clearTimeout(localCountdownTimer);\n    localCountdownTimer = null;\n    currentRoundEndsAt  = null;\n}\n\nfunction updateTimerDisplay(seconds) {\n    var el = document.getElementById('bet-timer');\n    if (!el) return;\n    el.innerHTML = '<i class=\"bi bi-clock-fill\"></i> Time: <span class=\"fw-bold\">' + seconds + '</span>s';\n    el.classList.remove('text-success', 'text-warning', 'text-danger');\n    if (seconds <= 5)       el.classList.add('text-danger');\n    else if (seconds <= 10) el.classList.add('text-warning');\n    else                    el.classList.add('text-success');\n}\n\nfunction setTimerLabel(text) {\n    var el = document.getElementById('bet-timer');\n    if (el) el.innerHTML = '<i class=\"bi bi-clock-fill\"></i> ' + text;\n}\n\nvar BET_DISPLAY_MAP = {\n    player:     'player-total',\n    banker:     'banker-total',\n    tie:        'tie-total',\n    playerPair: 'player-pair-total',\n    bankerPair: 'banker-pair-total',\n    randomPair: 'random-pair-total',\n};\n\nfunction updateBetDisplay(betType) {\n    var el = document.getElementById(BET_DISPLAY_MAP[betType]);\n    if (el) el.textContent = currentBets[betType];\n}\n\nfunction updateBalanceDisplay() {\n    ['player-balance', 'player-balance-side'].forEach(function (id) {\n        var el = document.getElementById(id);\n        if (el) el.textContent = Number(playerBalance).toLocaleString();\n    });\n    // Keep localStorage in sync so the correct balance is shown on next page load.\n    localStorage.setItem('player_balance', playerBalance);\n}\n\nfunction setPlayerCount(n) {\n    var el = document.getElementById('player-count');\n    if (el) el.textContent = n;\n}\n\nfunction renderLeaderboard(leaders, activePlayers) {\n    var el = document.getElementById('leaderboard');\n    if (!el) return;\n    var activeIds = Object.keys(activePlayers || {}).map(Number);\n    el.innerHTML = leaders.map(function (p, i) {\n        var isMe     = p.id === playerId;\n        var isActive = activeIds.indexOf(p.id) !== -1;\n        return '<div class=\"d-flex justify-content-between align-items-center py-1 border-bottom border-secondary small\">'\n            + '<span class=\"text-warning fw-bold\">#' + (i + 1) + '</span>'\n            + '<span class=\"' + (isMe ? 'text-warning fw-bold' : 'text-white') + '\">'\n            + escHtml(p.player_name) + (isActive ? ' \\uD83D\\uDFE2' : '')\n            + '</span>'\n            + '<span class=\"text-success fw-bold\">' + Number(p.balance).toLocaleString() + '</span>'\n            + '</div>';\n    }).join('');\n}\n\nfunction renderActivityFeed(items) {\n    var el = document.getElementById('activity-feed');\n    if (!el) return;\n    el.innerHTML = items.slice(0, 5).map(function (a) {\n        return '<div class=\"activity-item small py-1\">\\uD83C\\uDFB2 ' + escHtml(a.message) + '</div>';\n    }).join('');\n}\n\nfunction addActivityItem(message) {\n    var el = document.getElementById('activity-feed');\n    if (!el) return;\n    var item     = document.createElement('div');\n    item.className   = 'activity-item small py-1';\n    item.textContent = message;\n    el.prepend(item);\n    while (el.children.length > 5) el.lastChild.remove();\n}\n\nfunction showToast(msg) {\n    var container = document.getElementById('toast-container');\n    if (!container) return;\n    var el     = document.createElement('div');\n    el.className   = 'toast-msg alert alert-dark py-1 px-3 mb-1 small';\n    el.textContent = msg;\n    container.appendChild(el);\n    setTimeout(function () { el.remove(); }, 3000);\n}\n\nfunction startCountdown(elementId, seconds, onDone) {\n    var count = seconds;\n    var el    = document.getElementById(elementId);\n    var tick  = function () {\n        if (el) el.textContent = count + 's';\n        if (count-- <= 0) { if (onDone) onDone(); }\n        else setTimeout(tick, 1000);\n    };\n    tick();\n}\n\nfunction escHtml(str) {\n    return String(str || '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n}\n\n// ── Expose for Blade onclick= attributes ─────────────────────────────────────\n\nwindow.handleBetClick = handleBetClick;\nwindow.clearAllBets   = clearAllBets;\nwindow.selectChip     = function (amount) {\n    selectedChip = amount;\n    document.querySelectorAll('.chip').forEach(function (c) {\n        c.classList.toggle('active', parseInt(c.dataset.value) === amount);\n    });\n};\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","playerId","playerBalance","currentRound","currentBets","player","banker","tie","playerPair","bankerPair","randomPair","selectedChip","hasBetThisRound","dealingShown","localCountdownTimer","currentRoundEndsAt","API_BASE","boot","console","log","window","Echo","channel","listen","data","myId","id","round_id","isNewRound","stopLocalCountdown","clearBets","status","round_ends_at","enableBetting","startLocalCountdown","setTimerLabel","message","el","document","getElementById","item","createElement","className","textContent","prepend","children","lastChild","remove","addActivityItem","player_name","total_bet","setPlayerCount","active_players","assign","disableBetting","showSharedCards","pLen","player_cards","playerCards","bLen","banker_cards","bankerCards","waitMs","Math","max","setTimeout","hideOverlays","seconds","wrapper","next_round_in","classList","startCountdown","add","new_balance","updateBalanceDisplay","animMs","resultEl","titleEl","detailsEl","result","replace","profit","abs","showResult","subscribeToPlayerChannel","fetchInitialState","_fetchInitialState","_callee","res","round","currentId","_t","_context","axios","get","current_round","player_balance","undefined","round_status","player_total","banker_total","leaderboard","renderLeaderboard","recent_activity","renderActivityFeed","keys","error","_handleBetClick","_callee2","box","betType","projected","wasWaiting","_t2","_context2","showToast","dataset","_defineProperty","values","reduce","s","updateBetDisplay","post","bets","balance","toUpperCase","some","response","_clearAllBets","_callee3","total","_context3","overlay","pHand","bHand","innerHTML","pScore","bScore","DELAY","pCards","bCards","forEach","card","appendCard","totalMs","playerTotal","bankerTotal","container","display","style","color","indexOf","suit","appendChild","k","querySelectorAll","b","roundEndsAt","tick","remaining","Date","now","updateTimerDisplay","clearTimeout","text","addEventListener","app","parseInt","playerName","readPlayerData","echoReady","once","attempts","poll","setInterval","clearInterval","removeEventListener","BET_DISPLAY_MAP","Number","toLocaleString","localStorage","setItem","leaders","activePlayers","activeIds","map","isMe","isActive","escHtml","join","items","slice","msg","elementId","onDone","count","str","String","handleBetClick","_x","clearAllBets","selectChip","amount","toggle"],"sourceRoot":""}